{
  "feature": "Job Application System",
  "description": "One-tap job application system for workers. Workers can apply for jobs, see their application status, and cancel applications before acceptance. Businesses receive real-time notifications for new applications.",
  "workflow_type": "feature",
  "workflow_rationale": "Feature workflow: Building a new multi-service feature (frontend + database) with clear dependencies. Database layer must be implemented first, then server actions, followed by UI components, and finally integration.",
  "phases": [
    {
      "id": "phase-1-database",
      "name": "Database Schema & Migrations",
      "type": "implementation",
      "description": "Add unique constraint to prevent duplicate applications and ensure proper RLS policies",
      "depends_on": [],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-1-1",
          "description": "Create database migration for job applications unique constraint",
          "service": "frontend",
          "files_to_create": [
            "supabase/migrations/20260222_add_application_unique_constraint.sql"
          ],
          "files_to_modify": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "supabase db reset --db-url 'postgresql://postgres:postgres@localhost:54322/postgres'",
            "expected": "Resetting database"
          },
          "status": "completed"
        },
        {
          "id": "subtask-1-2",
          "description": "Create Row Level Security (RLS) policies for bookings table",
          "service": "frontend",
          "files_to_create": [
            "supabase/migrations/20260222_add_bookings_rls_policies.sql"
          ],
          "files_to_modify": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "supabase migration up",
            "expected": "Applied migration"
          },
          "status": "completed"
        }
      ]
    },
    {
      "id": "phase-2-server-actions",
      "name": "Server Actions & API Layer",
      "type": "implementation",
      "description": "Create server actions for job applications (apply, cancel, accept, reject) and notifications",
      "depends_on": [
        "phase-1-database"
      ],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-2-1",
          "description": "Create job application server actions (apply, cancel, check duplicate)",
          "service": "frontend",
          "files_to_create": [
            "lib/actions/job-applications.ts"
          ],
          "files_to_modify": [],
          "patterns_from": [
            "app/app/providers/auth-provider.tsx"
          ],
          "verification": {
            "type": "command",
            "command": "npm run type-check",
            "expected": "No TypeScript errors"
          },
          "status": "completed"
        },
        {
          "id": "subtask-2-2",
          "description": "Create notification server actions (create, mark read, get unread)",
          "service": "frontend",
          "files_to_create": [
            "lib/actions/notifications.ts"
          ],
          "files_to_modify": [],
          "patterns_from": [
            "lib/actions/job-applications.ts"
          ],
          "verification": {
            "type": "command",
            "command": "npm run type-check",
            "expected": "No TypeScript errors"
          },
          "status": "pending"
        },
        {
          "id": "subtask-2-3",
          "description": "Create data fetching utilities (get jobs, get applications, get applicants)",
          "service": "frontend",
          "files_to_create": [
            "lib/data/jobs.ts"
          ],
          "files_to_modify": [],
          "patterns_from": [
            "lib/actions/job-applications.ts"
          ],
          "verification": {
            "type": "command",
            "command": "npm run type-check",
            "expected": "No TypeScript errors"
          },
          "status": "pending"
        }
      ]
    },
    {
      "id": "phase-3-ui-components",
      "name": "UI Components",
      "type": "implementation",
      "description": "Create reusable UI components for job cards and application lists",
      "depends_on": [
        "phase-2-server-actions"
      ],
      "parallel_safe": true,
      "subtasks": [
        {
          "id": "subtask-3-1",
          "description": "Create JobCard component for displaying available jobs",
          "service": "frontend",
          "files_to_create": [
            "components/job-card.tsx"
          ],
          "files_to_modify": [],
          "patterns_from": [
            "components/ui/card.tsx",
            "components/ui/button.tsx"
          ],
          "verification": {
            "type": "command",
            "command": "npm run type-check",
            "expected": "No TypeScript errors"
          },
          "status": "pending"
        },
        {
          "id": "subtask-3-2",
          "description": "Create ApplicationList component for worker application history",
          "service": "frontend",
          "files_to_create": [
            "components/application-list.tsx"
          ],
          "files_to_modify": [],
          "patterns_from": [
            "components/ui/table.tsx",
            "components/ui/badge.tsx"
          ],
          "verification": {
            "type": "command",
            "command": "npm run type-check",
            "expected": "No TypeScript errors"
          },
          "status": "pending"
        },
        {
          "id": "subtask-3-3",
          "description": "Create ApplicantList component for business view of applicants",
          "service": "frontend",
          "files_to_create": [
            "components/applicant-list.tsx"
          ],
          "files_to_modify": [],
          "patterns_from": [
            "components/ui/table.tsx",
            "components/ui/button.tsx"
          ],
          "verification": {
            "type": "command",
            "command": "npm run type-check",
            "expected": "No TypeScript errors"
          },
          "status": "pending"
        }
      ]
    },
    {
      "id": "phase-4-worker-dashboard",
      "name": "Worker Dashboard",
      "type": "implementation",
      "description": "Implement worker job browsing and application features",
      "depends_on": [
        "phase-3-ui-components"
      ],
      "parallel_safe": true,
      "subtasks": [
        {
          "id": "subtask-4-1",
          "description": "Implement worker jobs page with job listing and one-tap apply",
          "service": "frontend",
          "files_to_modify": [
            "app/app/(dashboard)/worker/jobs/page.tsx"
          ],
          "files_to_create": [],
          "patterns_from": [
            "app/app/providers/auth-provider.tsx"
          ],
          "verification": {
            "type": "browser",
            "url": "http://localhost:3000/dashboard-worker-jobs",
            "checks": [
              "Job list renders",
              "Apply button is visible for open jobs",
              "No console errors"
            ]
          },
          "status": "pending"
        },
        {
          "id": "subtask-4-2",
          "description": "Implement application history view with status badges",
          "service": "frontend",
          "files_to_modify": [
            "app/app/(dashboard)/worker/jobs/page.tsx"
          ],
          "files_to_create": [],
          "patterns_from": [
            "components/ui/badge.tsx"
          ],
          "verification": {
            "type": "browser",
            "url": "http://localhost:3000/dashboard-worker-jobs",
            "checks": [
              "Application history shows",
              "Status badges display correctly (pending/accepted/rejected)"
            ]
          },
          "status": "pending"
        },
        {
          "id": "subtask-4-3",
          "description": "Implement cancel application functionality for pending applications",
          "service": "frontend",
          "files_to_modify": [
            "app/app/(dashboard)/worker/jobs/page.tsx"
          ],
          "files_to_create": [],
          "patterns_from": [
            "components/ui/dialog.tsx"
          ],
          "verification": {
            "type": "browser",
            "url": "http://localhost:3000/dashboard-worker-jobs",
            "checks": [
              "Cancel button appears for pending applications",
              "Cancel confirmation dialog works",
              "Application is removed after cancellation"
            ]
          },
          "status": "pending"
        }
      ]
    },
    {
      "id": "phase-5-business-dashboard",
      "name": "Business Dashboard",
      "type": "implementation",
      "description": "Implement business job management and applicant review features",
      "depends_on": [
        "phase-3-ui-components"
      ],
      "parallel_safe": true,
      "subtasks": [
        {
          "id": "subtask-5-1",
          "description": "Implement business jobs page with applicant listings",
          "service": "frontend",
          "files_to_modify": [
            "app/app/(dashboard)/business/jobs/page.tsx"
          ],
          "files_to_create": [],
          "patterns_from": [
            "app/app/providers/auth-provider.tsx"
          ],
          "verification": {
            "type": "browser",
            "url": "http://localhost:3000/dashboard-business-jobs",
            "checks": [
              "Job listings show applicant count",
              "Applicant list displays for each job"
            ]
          },
          "status": "pending"
        },
        {
          "id": "subtask-5-2",
          "description": "Implement accept/reject applicant functionality",
          "service": "frontend",
          "files_to_modify": [
            "app/app/(dashboard)/business/jobs/page.tsx"
          ],
          "files_to_create": [],
          "patterns_from": [
            "components/ui/dialog.tsx"
          ],
          "verification": {
            "type": "browser",
            "url": "http://localhost:3000/dashboard-business-jobs",
            "checks": [
              "Accept button appears for pending applicants",
              "Reject button appears for pending applicants",
              "Status updates correctly after action"
            ]
          },
          "status": "pending"
        }
      ]
    },
    {
      "id": "phase-6-integration",
      "name": "Integration & Notifications",
      "type": "integration",
      "description": "Integrate all components and implement real-time notifications",
      "depends_on": [
        "phase-4-worker-dashboard",
        "phase-5-business-dashboard"
      ],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-6-1",
          "description": "Implement notification system integration",
          "service": "frontend",
          "files_to_modify": [
            "app/app/layout.tsx",
            "app/app/providers/auth-provider.tsx"
          ],
          "files_to_create": [
            "components/notification-toast.tsx"
          ],
          "patterns_from": [
            "components/ui/sonner.tsx"
          ],
          "verification": {
            "type": "browser",
            "url": "http://localhost:3000",
            "checks": [
              "Business receives notification when worker applies",
              "Worker receives notification when application is accepted/rejected"
            ]
          },
          "status": "pending"
        },
        {
          "id": "subtask-6-2",
          "description": "End-to-end verification of job application flow",
          "all_services": true,
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "e2e",
            "steps": [
              "Worker logs in and browses available jobs",
              "Worker applies for a job with one tap",
              "Business receives notification of new application",
              "Business reviews applicant and accepts",
              "Worker receives acceptance notification",
              "Worker can view updated application status",
              "Worker can cancel pending application"
            ]
          },
          "status": "pending"
        }
      ]
    }
  ],
  "summary": {
    "total_phases": 6,
    "total_subtasks": 16,
    "services_involved": [
      "frontend"
    ],
    "parallelism": {
      "max_parallel_phases": 2,
      "parallel_groups": [
        {
          "phases": [
            "phase-4-worker-dashboard",
            "phase-5-business-dashboard"
          ],
          "reason": "Both depend only on phase-3 (UI Components) and modify different pages"
        }
      ],
      "recommended_workers": 1,
      "speedup_estimate": "Sequential execution recommended - shared state management"
    },
    "startup_command": "npm run dev"
  },
  "verification_strategy": {
    "risk_level": "medium",
    "skip_validation": false,
    "test_creation_phase": "post_implementation",
    "test_types_required": [
      "unit",
      "integration"
    ],
    "security_scanning_required": false,
    "staging_deployment_required": false,
    "acceptance_criteria": [
      "All existing tests pass",
      "New code has type safety (TypeScript)",
      "No console errors in browser",
      "All acceptance criteria from spec are met"
    ],
    "verification_steps": [
      {
        "name": "TypeScript Type Check",
        "command": "npm run type-check",
        "expected_outcome": "No TypeScript errors",
        "type": "test",
        "required": true,
        "blocking": true
      },
      {
        "name": "ESLint Check",
        "command": "npm run lint",
        "expected_outcome": "No linting errors",
        "type": "test",
        "required": true,
        "blocking": false
      },
      {
        "name": "Browser Verification - Worker Dashboard",
        "command": "Manual: Visit http://localhost:3000/dashboard-worker-jobs",
        "expected_outcome": "Page renders, jobs display, apply buttons work",
        "type": "manual",
        "required": true,
        "blocking": true
      },
      {
        "name": "Browser Verification - Business Dashboard",
        "command": "Manual: Visit http://localhost:3000/dashboard-business-jobs",
        "expected_outcome": "Page renders, applicants display, accept/reject works",
        "type": "manual",
        "required": true,
        "blocking": true
      }
    ],
    "reasoning": "Medium risk change adds new functionality to existing dashboards. Requires TypeScript type safety verification and manual browser testing due to interactive UI components."
  },
  "qa_acceptance": {
    "unit_tests": {
      "required": false,
      "commands": [],
      "minimum_coverage": null,
      "note": "Project does not have unit test setup yet"
    },
    "integration_tests": {
      "required": false,
      "commands": [],
      "services_to_test": [],
      "note": "Project does not have integration test setup yet"
    },
    "e2e_tests": {
      "required": false,
      "commands": [],
      "flows": [],
      "note": "Project does not have E2E test setup yet"
    },
    "browser_verification": {
      "required": true,
      "pages": [
        {
          "url": "http://localhost:3000/dashboard-worker-jobs",
          "checks": [
            "Job list renders with apply buttons",
            "Application status badges display correctly",
            "Cancel button works for pending applications",
            "No console errors"
          ]
        },
        {
          "url": "http://localhost:3000/dashboard-business-jobs",
          "checks": [
            "Jobs list with applicant counts renders",
            "Accept/reject buttons work for pending applicants",
            "Notifications display for new applications",
            "No console errors"
          ]
        }
      ]
    },
    "database_verification": {
      "required": true,
      "checks": [
        "Unique constraint prevents duplicate applications",
        "RLS policies restrict access to own applications",
        "Notifications are created on application events"
      ]
    }
  },
  "qa_signoff": null,
  "status": "in_progress",
  "planStatus": "in_progress",
  "xstateState": "backlog",
  "executionPhase": "coding",
  "updated_at": "2026-02-22T03:57:26.880Z"
}